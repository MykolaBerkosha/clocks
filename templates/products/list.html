
{% extends 'base.html' %}

{% load i18n %}


{% block content %}

    <h4>{{ category.name }}</h4>

    <ul>
        {% for product in page_obj.object_list %}
            <li>
                <a href="{{ product.get_absolute_url }}">
                    {{ product.name }} - ${{ product.price }}
                </a>
                {% if request.user.is_staff %}
                    <button type="button" data-role="edit-product" data-url="{% url 'admin:products_product_change' product.id %}?_popup=1">
                        {% trans "Edit" %}
                    </button>
                {% endif %}
                {% if product.logo %}
                    <img src="{{ product.logo.url }}" width="100">
                {% else %}
                    No logo
                {% endif %}
            </li>
        {% endfor %}
    </ul>

    {{ page_obj.render }}

{% endblock %}


{% block js %}
    {{ block.super }}
    <script>
        (function ($) {
            $('[data-role=edit-product]').on('click', function () {
                window.open(
                    $(this).data('url'),
                    "",
                    "left=100,top=100,width=1000,height=600"
                );
            });

            window.dismissChangeRelatedObjectPopup = function (popup) {
                popup.close();
                window.location.reload();
            };
        })(jQuery);
    </script>
{% endblock %}
